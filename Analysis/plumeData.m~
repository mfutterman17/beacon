function [dataSet] = plumeData(dataSet)

% make summary table to store data
varNames = {'Condition', 'numPlumes', 'meanEF', 'medianEF', 'meanR', 'medianR', 'meanP', 'medianP', 'meanTemp', 'medianTemp', 'meanTempPlumes', 'medianTempPlumes'};
varTypes = {'cell' , 'double', 'double', 'double', 'double', 'double', 'double', 'double', 'double', 'double', 'double', 'double'};
summary = table ('Size', [2 12], 'VariableTypes', varTypes);
summary.Properties.VariableNames = varNames;
summary.Condition = {'none'; 'Rsqr > 0.6'};

%% full dataset
% calculate number of plumes
numPlumes = find (~ismissing(dataSet.PlumeCO));
Plumes1 = dataSet (numPlumes, :);
summary.numPlumes (1) = height(Plumes1);

% save Plumes1 to output structure
output = struct( 'all_plumes', Plumes1);

% fill table
summary.meanEF (1) = mean (Plumes1.EF, 'omitnan');
summary.medianEF (1) = median (Plumes1.EF, 'omitnan');
summary.meanR (1) = mean (Plumes1.rsquare, 'omitnan');
summary.medianR (1) = median (Plumes1.rsquare, 'omitnan'); 
summary.meanP (1) = mean (Plumes1.pCO,'omitnan');
summary.medianP (1) = median (Plumes1.pCO, 'omitnan');
summary.meanTemp (1) = mean (dataset.Temp2, 'ominan');
summary.medianTemp (1) = median (dataset.Temp2, 'ominan');
summary.meanTempPlumes (1) = mean (Plumes1.Temp2, 'omitnan');
summary.medianTempPlumes (2) = median (Plumes2.Temp2, 'ominan');

%% Rsquar% calculate number of plumes
numPlumes = find (Plumes1.rsquare > 0.6);
Plumes2 = Plumes1 (numPlumes, :);
summary.numPlumes (2) = height(Plumes2);

% save Plumes2 to output structure
output.Rcondition = Plumes2;

% fill table
summary.meanEF (2) = mean (Plumes2.EF, 'omitnan');
summary.medianEF (2) = median (Plumes2.EF, 'omitnan');
summary.meanR (2) = mean (Plumes2.rsquare, 'omitnan');
summary.medianR (2) = median (Plumes2.rsquare, 'omitnan'); 
summary.meanP (2) = mean (Plumes2.pCO,'omitnan');
summary.medianP (2) = median (Plumes2.pCO, 'omitnan');
summary.meanTemp (2) = mean (dataset.Temp2, 'ominan');
summary.medianTemp (2) = median (dataset.Temp2, 'ominan');
summary.meanTempPlumes (2) = mean (Plumes2.Temp2, 'omitnan');
summary.medianTempPlumes (2) = median (Plumes2.Temp2, 'ominan');

% save summary to output structure
output.summary = summary;

end

